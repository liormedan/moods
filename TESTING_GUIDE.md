# מדריך בדיקות - הפרדת מידע אישי 100%

## סקירה כללית

מערכת הבדיקות המקיפה כוללת שלושה סוגי בדיקות עיקריים:

1. **🔒 בדיקות אבטחה** - בודקות הפרדת מידע אישי
2. **🗄️ בדיקות תיאום מסד נתונים** - בודקות עקביות וסינכרון נתונים
3. **🔗 בדיקות אינטגרציה** - בודקות את כל המערכת יחד

## קבצי בדיקה

### 1. בדיקות אבטחה

- **קובץ**: `src/test/security-tests.ts`
- **סקריפט**: `scripts/run-security-tests.js`
- **מטרה**: בדיקה שהמערכת מגנה על הפרדת מידע אישי

### 2. בדיקות תיאום מסד נתונים

- **קובץ**: `src/test/database-sync-tests.ts`
- **סקריפט**: `scripts/run-database-sync-tests.js`
- **מטרה**: בדיקה שכל הנתונים מסונכים נכון בין המשתמשים

### 3. בדיקות אינטגרציה

- **קובץ**: `src/test/integration-tests.ts`
- **מטרה**: בדיקה מקיפה של כל המערכת יחד

### 4. סקריפט ראשי

- **קובץ**: `scripts/run-all-tests.js`
- **מטרה**: הרצת כל הבדיקות יחד

## הרצת בדיקות

### הרצת כל הבדיקות (מומלץ)

```bash
# מתיקיית mental-health-tracker
node scripts/run-all-tests.js
```

### הרצת בדיקות אבטחה בלבד

```bash
node scripts/run-security-tests.js
```

### הרצת בדיקות תיאום מסד נתונים בלבד

```bash
node scripts/run-database-sync-tests.js
```

### הרצת בדיקות TypeScript

```bash
# אם יש לך TypeScript מותקן
npm run test:security
npm run test:database
npm run test:integration
```

## סוגי בדיקות

### 🔒 בדיקות אבטחה (25 נקודות כל אחת)

#### 1. הפרדת נתוני מצב רוח

- בודקת שמשתמשים רואים רק את ה-mood entries שלהם
- בודקת שאין גישה לנתונים של משתמשים אחרים
- בודקת שכל הנתונים מסוננים לפי `userId`

#### 2. הפרדת תובנות

- בודקת שמשתמשים רואים רק את ה-insights שלהם
- בודקת שאין דליפת תובנות בין משתמשים
- בודקת שכל התובנות מקושרות למשתמש הנכון

#### 3. הרשאות API

- בודקת שמשתמשים לא יכולים לגשת לנתונים של אחרים
- בודקת שכל בקשות ה-API מוגנות
- בודקת שסינון הנתונים עובד ברמת מסד הנתונים

#### 4. הגנת Middleware

- בודקת שה-Middleware חוסם בקשות לא מורשות
- בודקת הפניה להתחברות למשתמשים לא מחוברים
- בודקת שכל הנתיבים מוגנים

### 🗄️ בדיקות תיאום מסד נתונים (25 נקודות כל אחת)

#### 1. יצירת משתמשים ונתונים

- בודקת יצירת משתמשי בדיקה
- בודקת יצירת נתונים לכל משתמש
- בודקת שכל הנתונים נוצרים בהצלחה

#### 2. הפרדת נתונים בין משתמשים

- בודקת שכל משתמש רואה רק את הנתונים שלו
- בודקת שאין גישה לנתונים של משתמשים אחרים
- בודקת שכל הנתונים מקושרים למשתמש הנכון

#### 3. עקביות נתונים

- בודקת שכל הנתונים קיימים במסד הנתונים
- בודקת שהקשרים בין הטבלאות נכונים
- בודקת שמספר הנתונים מדויק

#### 4. ביצועים וסינון

- בודקת ביצועי סינון לפי משתמש
- בודקת שכל הנתונים מסוננים נכון
- בודקת זמני ביצוע

### 🔗 בדיקות אינטגרציה (33 נקודות כל אחת)

#### 1. אינטגרציה מלאה

- בודקת שכל המערכות עובדות יחד
- בודקת יצירת משתמשים ונתונים מלאה
- בודקת הפרדת נתונים מלאה

#### 2. זרימת נתונים מלאה

- בודקת זרימת נתונים מקצה לקצה
- בודקת שכל הקשרים עובדים
- בודקת שכל הנתונים נטענים נכון

#### 3. ביצועים תחת עומס

- בודקת ביצועים עם 10 משתמשים
- בודקת סינון תחת עומס
- בודקת יציבות המערכת

## תוצאות בדיקות

### ציונים

- **100%** - מעולה! המערכת עובדת בצורה מושלמת
- **90%+** - מעולה! יש כמה בעיות קטנות
- **75%+** - טוב! יש בעיות שצריך לטפל בהן
- **פחות מ-75%** - יש בעיות משמעותיות

### קטגוריות

- **🔒 אבטחה**: הפרדת מידע אישי
- **🗄️ תיאום מסד נתונים**: עקביות וסינכרון
- **🔗 אינטגרציה**: עבודה משולבת

## פתרון בעיות

### בעיה: מסד נתונים לא מוכן

```bash
# ניסיון תיקון אוטומטי
npx prisma migrate reset --force
npx prisma generate
npx prisma db push
```

### בעיה: חבילות לא מותקנות

```bash
# התקנת חבילות נדרשות
npm install @prisma/client next react
```

### בעיה: בדיקות נכשלות

1. בדוק שהמסד נתונים מוכן
2. בדוק שכל החבילות מותקנות
3. בדוק שהמערכת רצה
4. בדוק את הלוגים לפרטים

## דוגמאות פלט

### פלט מוצלח

```
🎉 מעולה! כל המערכת עובדת ב-100%!
🔒 אבטחה מושלמת - הפרדת מידע אישי 100%
🗄️  תיאום מסד נתונים מושלם
🔗 אינטגרציה מושלמת
✅ המערכת מוכנה לשימוש ייצור!
```

### פלט עם בעיות

```
⚠️  יש בעיות במערכת
📝 נדרשות 25 נקודות נוספות
```

## תחזוקה

### עדכון בדיקות

- עדכן את קבצי הבדיקה כשמוסיפים פיצ'רים חדשים
- הוסף בדיקות חדשות לקטגוריות הקיימות
- עדכן את הסקריפטים הראשיים

### ניקוי נתונים

- כל הבדיקות מנקות את נתוני הבדיקה שלהן
- אין צורך בניקוי ידני
- הבדיקות לא משפיעות על נתוני ייצור

## סיכום

מערכת הבדיקות המקיפה מבטיחה:

✅ **אבטחה מלאה** - הפרדת מידע אישי 100%  
✅ **עקביות נתונים** - כל הנתונים מסונכים נכון  
✅ **ביצועים טובים** - המערכת עובדת תחת עומס  
✅ **אינטגרציה מושלמת** - כל המערכות עובדות יחד

הרץ את הבדיקות לפני כל deployment כדי לוודא שהמערכת עובדת בצורה מושלמת!

